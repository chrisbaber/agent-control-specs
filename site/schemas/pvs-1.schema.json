{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://acontrollayer.com/schemas/pvs-1.schema.json",
  "title": "PVS-1 Policy Verdict Schema",
  "description": "JSON Schema for Policy Verdict Schema (PVS-1) records",
  "type": "object",
  "required": ["version", "approved", "reasoning", "policy_violations", "confidence_score"],
  "properties": {
    "version": {
      "type": "string",
      "const": "pvs-1",
      "description": "Schema version identifier"
    },
    "approved": {
      "type": "boolean",
      "description": "True if content is allowed to proceed, false otherwise"
    },
    "reasoning": {
      "type": "string",
      "description": "Human-readable explanation of the decision"
    },
    "policy_violations": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Array of violated policy descriptions. Empty if approved is true."
    },
    "confidence_score": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "Engine confidence in the verdict (0.0 to 1.0)"
    },
    "policy_set": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Array of policy names that were evaluated"
    },
    "metadata": {
      "type": "object",
      "description": "Engine-specific metadata",
      "properties": {
        "engine": {
          "type": "string",
          "description": "Policy engine identifier (e.g., 'the-gavel')"
        },
        "engine_version": {
          "type": "string",
          "description": "Semantic version of the policy engine"
        },
        "latency_ms": {
          "type": "integer",
          "minimum": 0,
          "description": "Evaluation latency in milliseconds"
        },
        "tenant_id": {
          "type": "string",
          "description": "Tenant identifier from calling context"
        },
        "agent_id": {
          "type": "string",
          "description": "Agent identifier from calling context"
        }
      }
    }
  },
  "if": {
    "properties": { "approved": { "const": true } }
  },
  "then": {
    "properties": {
      "policy_violations": {
        "maxItems": 0
      }
    }
  },
  "examples": [
    {
      "version": "pvs-1",
      "approved": true,
      "reasoning": "Content complies with all policies.",
      "policy_violations": [],
      "confidence_score": 0.97,
      "policy_set": ["No PII leakage", "No financial advice"],
      "metadata": {
        "engine": "the-gavel",
        "engine_version": "1.0.0",
        "latency_ms": 520
      }
    },
    {
      "version": "pvs-1",
      "approved": false,
      "reasoning": "Draft contained direct SSN.",
      "policy_violations": ["No PII leakage"],
      "confidence_score": 0.98,
      "policy_set": ["No PII leakage", "No financial advice"],
      "metadata": {
        "engine": "the-gavel",
        "latency_ms": 650
      }
    }
  ]
}
